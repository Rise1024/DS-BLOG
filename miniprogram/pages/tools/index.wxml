<!--index.wxml-->
<view class="container">
  <picker mode="selector" range="{{rssList}}" range-key="description" value="{{selectedRssIndex}}" bindchange="handleRssChange">
    <view class="picker" wx:if="{{rssList && rssList.length > 0 && selectedRssIndex !== null}}">当前选择：{{rssList[selectedRssIndex].description}}</view>
    <view class="picker" wx:else>请选择RSS源</view>
  </picker>
  <towxml nodes="{{article}}"/>
  
  <!-- 大纲按钮 -->
  <view wx:if="{{headings && headings.length > 0}}" class="outline-btn" bindtap="toggleOutline">
    <text class="outline-icon">📋</text>
    <text class="outline-text">大纲</text>
  </view>

  <!-- 大纲抽屉 -->
  <view wx:if="{{showOutline}}" class="outline-overlay" bindtap="closeOutline">
    <view class="outline-drawer" catchtap="">
      <!-- 抽屉头部 -->
      <view class="outline-header">
        <text class="outline-title">文章大纲</text>
        <text class="outline-close" bindtap="closeOutline">✕</text>
      </view>
      
      <!-- 大纲列表 -->
      <scroll-view class="outline-content" scroll-y="true">
        <view 
          wx:for="{{headings}}" 
          wx:key="anchor"
          class="outline-item level-{{item.level}} {{currentHeading === item.anchor ? 'active' : ''}}"
          data-anchor="{{item.anchor}}"
          data-title="{{item.title}}"
          bindtap="scrollToHeading"
        >
          <text class="outline-item-text">{{item.title}}</text>
        </view>
      </scroll-view>
    </view>
  </view>
  
  <!-- 已存在的分享按钮 -->
  <button 
    class="share-btn" 
    bindtap="handleShareImage"
    style="position: fixed; right: 20rpx; bottom: 50rpx; background: #007aff; color: white; border-radius: 50rpx; padding: 10rpx 20rpx;">
    生成分享图片
  </button>
</view>