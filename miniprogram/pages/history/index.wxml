<view class="container">
  <view class="history-list" wx:if="{{!loading && historyList.length > 0}}">
    <view class="history-group" wx:for="{{historyList}}" wx:key="article_id">
      <view class="group-header" bindtap="toggleGroup" data-index="{{index}}">
        <text class="group-date">{{item.created_at}}</text>
        <view class="group-arrow {{item.isExpanded ? 'expanded' : ''}}">
          <text class="arrow-icon">></text>
        </view>
      </view>
      <view class="group-content {{item.isExpanded ? 'expanded' : ''}}">
        <scroll-view class="image-scroll" scroll-x="true" enhanced="true" show-scrollbar="false">
          <view class="image-list">
            <view class="image-item" wx:for="{{item.image_urls}}" wx:for-item="imageUrl" wx:key="*this">
              <image 
                class="history-image" 
                src="{{imageUrl}}" 
                mode="aspectFill"
                data-urls="{{item.image_urls}}"
                data-current="{{imageUrl}}"
                bindtap="previewImage"
              />
              <view class="image-actions">
                <button 
                  class="action-btn download-btn" 
                  size="mini"
                  data-url="{{imageUrl}}"
                  bindtap="downloadImage"
                  hover-class="btn-hover"
                >下载</button>
              </view>
            </view>
          </view>
        </scroll-view>
        <button 
          class="action-btn delete-btn" 
          size="mini"
          data-article-id="{{item.article_id}}"
          bindtap="deleteHistory"
          hover-class="btn-hover"
        >删除</button>
      </view>
    </view>
  </view>

  <view class="empty-state" wx:if="{{!loading && historyList.length === 0}}">
    <image class="empty-icon" src="/images/empty.png" mode="aspectFit" />
    <text class="empty-text">暂无历史记录</text>
  </view>

  <view class="loading-state" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
</view>